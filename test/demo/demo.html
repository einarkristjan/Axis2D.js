<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />

  <title> axis.js demo </title>

  <style>

    html {
      display: table;

      width: 100%;
      height: 100%;
    }

    body {
      display: table-cell;

      vertical-align: middle;
      text-align: center;

      overflow: hidden;
    }
  </style>

</head>
<body>

  <canvas>You need a browser that supports the Canvas element</canvas>
  <script>
    (function(){
      var canvas = document.querySelector('canvas'),
          ctx = canvas.getContext('2d');
      ctx.textAlign = 'center';
      ctx.fillText('Loading...', canvas.width/2, canvas.height/2);
    })();
  </script>

  <script src="../../src/axis.js"></script>
  <script src="../../src/axis.world.js"></script>
  <script src="../../src/axis.collider.js"></script>

  <script src="demo.vector2.js"></script>
  <script src="demo.world.js"></script>
  <script src="demo.canvasrenderer.js"></script>
  <script src="demo.entitymanager.js"></script>
  <script src="demo.entity.js"></script>

  <script>
(function(){
  // paul irish shim
  var requestAnimFrame = (function(){
    return  window.requestAnimationFrame       ||
            window.webkitRequestAnimationFrame ||
            window.mozRequestAnimationFrame    ||
            function( callback ){
              setTimeout(callback, 1000 / 60);
            };
  })();

  var width = 768,
      height = 576,
      canvas = document.querySelector('canvas'),
      renderer = new DEMO.CanvasRenderer(canvas, width, height),
      axisWorld = new DEMO.World({
        renderer: renderer,
        debug: true
      });

  function onWindowResize() {
    renderer.scaleTo(window.innerWidth, window.innerHeight);
  }

  window.addEventListener('resize', onWindowResize);

  // first run
  onWindowResize();

  axisWorld
    .createCollisionMap([
      [1, 1, 1, 1, 0, 0, 0, 0, 1, 1, 1, 1],
      [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
      [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
      [0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0],
      [0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0],
      [0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0],
      [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
      [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
      [1, 1, 1, 1, 0, 0, 0, 0, 1, 1, 1, 1]
    ]);

  axisWorld
    .createEntity(123, 121)
      .setCollider(100, 100, -50, -50)
      .setUserData({
        foo: 123,
        bar: function() {
          return this.foo;
        }
      })
      .setLoop(function() {
        if(this.world._frameCount === 50) {
          this.moveTo(300, 250);
          console.log(this.userData.bar());
        }
      })
      .onCollision(function(entity){
        // console.log(entity.collider);
      });

  (function loop() {
    requestAnimFrame(loop);

    axisWorld.update();

    // draw background
    renderer.setColor(0, 0, 0);
    renderer.fillRect(0, 0, width, height);

    axisWorld.draw();
  })();

})();
  </script>
</body>
</html>
